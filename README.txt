This is a brief guide to the supplemental data and code associated with
"Multiplexed Exchange-PAINT imaging reveals ligand-dependent EGFR and Met
interactions in the plasma membrane" by Werbin et al.
DOI:10.1038/s41598-017-12257-y
SREP-17-12972

The data files referenced below are available at the following location:

http://lincs.hms.harvard.edu/werbin-sci-rep-2017/


Data
-------------
All the associated data is contained in the data folder and is stored in .mat
files. They can be loaded into matlab using the following command

load filename; 

The files are 3 different types based on their contents.

*_PointList.mat :
Contains a cell array of structs called a PointList.
Each element of the cell array has all the localization data for a single channel.
The channels are designated by which DNA Paint imaging strand was used to generate the image. 
P1 = EGFR, P4 = ErbB2, P5 = ErbB3, P11 = IGF1R, P13 = cMet


The struct has 
pnts- a n x 2 array with the aligned (to other chnanels) drift corrected xy coordinates in pixels of the n localizations.
name- original filename
drift - the x,y shift applied to each frame for drift correction
dmark - a nx2 array with the xy location of th drift markers
shift - the shift in pixel to align this channel to the other channels
fullData - the full localization output produced by the Wyss localization software.


*_MeanShiftCluster.mat:
Contains the results of MeanShiftClustering the point list using wyssFileMeanShiftManualAligned.m
It contains 3 objects.
TotalPnts - a n x 3 array of all localizations for this image. The columns are [x,y, PointListIdx] where the PointListIdx, indicates which channel this localization comes from. This is a number from 1 to 5. In general 1 = P11, 2=P13,3=P1,4=P4,5=P5.

clusterInfo - a struct array with information about each cluster found by mean shift. 
	    -ptClusterCenter: xy pos of cluster center in pixels
	    -ptIdData: index of points in cluster
	    -numPoints: number of points in cluster
	    -composition: 1x5 array with counts of number of points by type (PointListIdx)
	    -pnts: x-y coordinates in pixels of all point in cluster
	    -area: the area of the cluster (defined by area of convex hull) in nm^2
	    -hull: index of which points in the .pnts array are in the convex hull.

clusterMap - an n x 1 array with the same # rows as TotalPnts. It gives the cluster # that each point belongs to.
 

allCompsMerged.mat :
Contains the compositions of all clusters contained within cells used for this
paper. The MeanShiftClustering results were confined to individual cells using
CellSelector.m. The compositions were divided by the area of the cluster and
then were all combined by treatment condition into the arrays contained in this
file. Then all 15 unique second order features were generated by multiplying
pairs of columns.

compEGF - n x 20 array. Containing density freatures from all clusters in EGF stimulated cells.

compUnstim - m x 20 array. Containing density features from all cluster in unstimulated cells

labelsExtra - a cell array with the labels for each column (feature)


Some examples of using provided code:

%run mean shift clusting
load 2014_04_09_BT20_01_manualAlign_PointList.mat;
wyssFileMeanShiftManualAligned(PointList,'2014_04_09_BT20_01_manualAlign_v2');


%Ripley's spatial statitics calculations

%First select a rectangular region completely inside of a cell using the following
load 2014_04_09_BT20_01_manualAlign_PointList.mat;
PL = CellSelectorRect(PointList);
newFN = 'new-file.mat';
save(newFN,'PL');
wyssFileRipley(newFN);


%Get Random Forests results
nTrees= 50;
load('allCompsMerged.mat')
'EGF Stim vs Unstim'
labelsExtra
RandomResampleTreeBaggerFunction(compEGF,compUnstim,'TreeBagger_EGFvsUnstim.mat',nTrees);

